install.packages(c("dplyr", "ggdark"))
### dataset
df <- read.csv('Seattle_Crime_Data.csv', header = T)
### set work space
setwd('topic/Crime/')
### dataset
df <- read.csv('Seattle_Crime_Data.csv', header = T)
head(df)
### sorting dataset to extract 'Occurred.Date' column
df01 <- df %>%
select('Occurred.Date')
### sorting dataset to extract 'Occurred.Date' column
df01 <- df %>% select('Occurred.Date')
library(dplyr)
library(ggplot2)
library(ggdark)
### set work space
setwd('topic/Crime/')
### dataset
df <- read.csv('Seattle_Crime_Data.csv', header = T)
head(df)
### sorting dataset to extract 'Occurred.Date' column
df01 <- df %>% select('Occurred.Date')
head(df01)
### substring years
year <- substr(df01$Occurred.Date, 7, 10)
head(year)
### changing data form
tb_year <- table(year)
head(tb_year)
### data framing
df_year <- as.data.frame(tb_year)
head(df_year)
# extracting specific years(2008~2018)
df <- df_year[35:45,]
mean_occr <- mean(df$Freq)
mean_occr
# making a graphic chart
ggplot(data = df, aes(x = year, y = Freq, group = 1)) +
geom_line(linetype = "dotted", color = "red", size = 2) +
geom_point(color = "blue", size = 3) +
labs(x = "Year", y = "Frequency", title = "The Number of Crime Occurrences per Each Year during the Last 10 years") +
dark_theme_gray() +
geom_hline(yintercept = mean_occr, color = "orange", size = 1) +
geom_text(aes(label = Freq), vjust = -0.3)
reg <- lm(Freq ~ year)
reg <- lm(df$Freq ~ df$year)
abline(reg)
summary(reg)
plot(reg)
# making a graphic chart
ggplot(data = df, aes(x = year, y = Freq, group = 1)) +
geom_line(linetype = "dotted", color = "red", size = 2) +
geom_point(color = "blue", size = 3) +
labs(x = "Year", y = "Frequency", title = "The Number of Crime Occurrences per Each Year during the Last 10 years") +
dark_theme_gray() +
geom_hline(yintercept = mean_occr, color = "orange", size = 1) +
geom_text(aes(label = Freq), vjust = -0.3)
# making a graphic chart
ggplot(data = df, aes(x = year, y = Freq, group = 1)) +
geom_line(linetype = "dotted", color = "red", size = 2) +
geom_point(color = "blue", size = 3) +
labs(x = "Year", y = "Frequency", title = "The Number of Crime Occurrences per Each Year during the Last 10 years") +
dark_theme_gray() +
geom_hline(yintercept = mean_occr, color = "orange", size = 1) +
geom_text(aes(label = Freq), vjust = -0.3) +
geom_abline(reg)
reg <- lm(df$Freq ~ df$year)
summary(reg)
# [1] 46084.45
class(df$Freq)
class(df$year)
mode(df$Freq)
mode(df$year)
summary(reg)
regFreq <- as.numeric(df$Freq)
viewClassNMode <- function(data) {
class(data)
mode(data)
}
viewClassNMode(regFreq)
viewClassNMode <- function(data) {
print(class(data) + '\n')
print(mode(data))
}
viewClassNMode(regFreq)
viewClassNMode <- function(data) {
print(class(data))
print(mode(data))
}
viewClassNMode(regFreq)
viewClassNMode <- function(data) {
print('class')
print(class(data))
print('\n mode')
print(mode(data))
}
viewClassNMode(regFreq)
viewClassNMode <- function(data) {
print('class')
print(class(data))
print('mode')
print(mode(data))
}
reg <- lm(df$Freq ~ df$year)
viewClassNMode(regFreq)
viewClassNMode <- function(data) {
cat('class' + class(data))
cat('\n' + 'mode' + mode(data))
}
viewClassNMode(regFreq)
viewClassNMode <- function(data) {
cat('class' + class(data))
cat('mode' + mode(data))
}
viewClassNMode(regFreq)
viewClassNMode <- function(data) {
cat('class : ', class(data))
cat('\n', 'mode', mode(data))
}
viewClassNMode(regFreq)
viewClassNMode <- function(data) {
cat('class:', class(data))
cat('\n','mode:', mode(data))
}
viewClassNMode(regFreq)
reg <- lm(formula = df$Freq ~ df$year)
summary(reg)
regYear <- as.numeric(df$year)
viewClassNMode(regYear)
reg <- lm(formula = regFreq ~ df$year)
reg <- lm(formula = regFreq ~ regYear)
summary(reg)
# making a graphic chart
ggplot(data = df, aes(x = year, y = Freq, group = 1)) +
geom_line(linetype = "dotted", color = "red", size = 2) +
geom_point(color = "blue", size = 3) +
labs(x = "Year", y = "Frequency", title = "The Number of Crime Occurrences per Each Year during the Last 10 years") +
dark_theme_gray() +
geom_hline(yintercept = mean_occr, color = "orange", size = 1) +
geom_text(aes(label = Freq), vjust = -0.3) +
geom_abline(reg)
# making a graphic chart
ggplot(data = df, aes(x = year, y = Freq, group = 1)) +
geom_line(linetype = "dotted", color = "red", size = 2) +
geom_point(color = "blue", size = 3) +
labs(x = "Year", y = "Frequency", title = "The Number of Crime Occurrences per Each Year during the Last 10 years") +
dark_theme_gray() +
geom_hline(yintercept = mean_occr, color = "orange", size = 1) +
geom_text(aes(label = Freq), vjust = -0.3) +
stat_smooth(method = 'lm', col = 'red')
summary(reg)
summary(reg)
